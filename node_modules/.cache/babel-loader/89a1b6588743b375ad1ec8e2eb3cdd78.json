{"remainingRequest":"/Users/thanitnetprokaew/Desktop/yfhs/website/node_modules/babel-loader/lib/index.js!/Users/thanitnetprokaew/Desktop/yfhs/website/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js??ref--13-0!/Users/thanitnetprokaew/Desktop/yfhs/website/src/state/modules/auth.js","dependencies":[{"path":"/Users/thanitnetprokaew/Desktop/yfhs/website/src/state/modules/auth.js","mtime":1655813586800},{"path":"/Users/thanitnetprokaew/Desktop/yfhs/website/node_modules/cache-loader/dist/cjs.js","mtime":1647752128109},{"path":"/Users/thanitnetprokaew/Desktop/yfhs/website/node_modules/babel-loader/lib/index.js","mtime":1647752127988},{"path":"/Users/thanitnetprokaew/Desktop/yfhs/website/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js","mtime":1647752168120}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCB7IGdldEZpcmViYXNlQmFja2VuZCB9IGZyb20gJy4uLy4uL2F1dGhVdGlscy5qcyc7CmV4cG9ydCB2YXIgc3RhdGUgPSB7CiAgY3VycmVudFVzZXI6IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ2F1dGhVc2VyJykKfTsKZXhwb3J0IHZhciBtdXRhdGlvbnMgPSB7CiAgU0VUX0NVUlJFTlRfVVNFUjogZnVuY3Rpb24gU0VUX0NVUlJFTlRfVVNFUihzdGF0ZSwgbmV3VmFsdWUpIHsKICAgIHN0YXRlLmN1cnJlbnRVc2VyID0gbmV3VmFsdWU7CiAgICBzYXZlU3RhdGUoJ2F1dGguY3VycmVudFVzZXInLCBuZXdWYWx1ZSk7CiAgfQp9OwpleHBvcnQgdmFyIGdldHRlcnMgPSB7CiAgbG9nZ2VkSW46IGZ1bmN0aW9uIGxvZ2dlZEluKHN0YXRlKSB7CiAgICByZXR1cm4gISFzdGF0ZS5jdXJyZW50VXNlcjsKICB9Cn07CmV4cG9ydCB2YXIgYWN0aW9ucyA9IHsKICBpbml0OiBmdW5jdGlvbiBpbml0KF9yZWYpIHsKICAgIHZhciBzdGF0ZSA9IF9yZWYuc3RhdGUsCiAgICAgICAgZGlzcGF0Y2ggPSBfcmVmLmRpc3BhdGNoOwogICAgZGlzcGF0Y2goJ3ZhbGlkYXRlJyk7CiAgfSwKICBsb2dJbjogZnVuY3Rpb24gbG9nSW4oX3JlZjIpIHsKICAgIHZhciBjb21taXQgPSBfcmVmMi5jb21taXQsCiAgICAgICAgZGlzcGF0Y2ggPSBfcmVmMi5kaXNwYXRjaCwKICAgICAgICBnZXR0ZXJzID0gX3JlZjIuZ2V0dGVyczsKCiAgICB2YXIgX3JlZjMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9LAogICAgICAgIGVtYWlsID0gX3JlZjMuZW1haWwsCiAgICAgICAgcGFzc3dvcmQgPSBfcmVmMy5wYXNzd29yZDsKCiAgICBpZiAoZ2V0dGVycy5sb2dnZWRJbikgcmV0dXJuIGRpc3BhdGNoKCd2YWxpZGF0ZScpOwogICAgcmV0dXJuIGdldEZpcmViYXNlQmFja2VuZCgpLmxvZ2luVXNlcihlbWFpbCwgcGFzc3dvcmQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgIHZhciB1c2VyID0gcmVzcG9uc2U7CiAgICAgIGNvbW1pdCgnU0VUX0NVUlJFTlRfVVNFUicsIHVzZXIpOwogICAgICByZXR1cm4gdXNlcjsKICAgIH0pOwogIH0sCiAgbG9nT3V0OiBmdW5jdGlvbiBsb2dPdXQoX3JlZjQpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgdmFyIGNvbW1pdCA9IF9yZWY0LmNvbW1pdDsKICAgIGNvbW1pdCgnU0VUX0NVUlJFTlRfVVNFUicsIG51bGwpOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgZ2V0RmlyZWJhc2VCYWNrZW5kKCkubG9nb3V0KCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICByZXNvbHZlKHRydWUpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZWplY3QoX3RoaXMuX2hhbmRsZUVycm9yKGVycm9yKSk7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICByZWdpc3RlcjogZnVuY3Rpb24gcmVnaXN0ZXIoX3JlZjUpIHsKICAgIHZhciBjb21taXQgPSBfcmVmNS5jb21taXQsCiAgICAgICAgZGlzcGF0Y2ggPSBfcmVmNS5kaXNwYXRjaCwKICAgICAgICBnZXR0ZXJzID0gX3JlZjUuZ2V0dGVyczsKCiAgICB2YXIgX3JlZjYgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9LAogICAgICAgIGVtYWlsID0gX3JlZjYuZW1haWwsCiAgICAgICAgcGFzc3dvcmQgPSBfcmVmNi5wYXNzd29yZDsKCiAgICBpZiAoZ2V0dGVycy5sb2dnZWRJbikgcmV0dXJuIGRpc3BhdGNoKCd2YWxpZGF0ZScpOwogICAgcmV0dXJuIGdldEZpcmViYXNlQmFja2VuZCgpLnJlZ2lzdGVyVXNlcihlbWFpbCwgcGFzc3dvcmQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgIHZhciB1c2VyID0gcmVzcG9uc2U7CiAgICAgIGNvbW1pdCgnU0VUX0NVUlJFTlRfVVNFUicsIHVzZXIpOwogICAgICByZXR1cm4gdXNlcjsKICAgIH0pOwogIH0sCiAgcmVzZXRQYXNzd29yZDogZnVuY3Rpb24gcmVzZXRQYXNzd29yZChfcmVmNykgewogICAgdmFyIGNvbW1pdCA9IF9yZWY3LmNvbW1pdCwKICAgICAgICBkaXNwYXRjaCA9IF9yZWY3LmRpc3BhdGNoLAogICAgICAgIGdldHRlcnMgPSBfcmVmNy5nZXR0ZXJzOwoKICAgIHZhciBfcmVmOCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge30sCiAgICAgICAgZW1haWwgPSBfcmVmOC5lbWFpbDsKCiAgICBpZiAoZ2V0dGVycy5sb2dnZWRJbikgcmV0dXJuIGRpc3BhdGNoKCd2YWxpZGF0ZScpOwogICAgcmV0dXJuIGdldEZpcmViYXNlQmFja2VuZCgpLmZvcmdldFBhc3N3b3JkKGVtYWlsKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICB2YXIgbWVzc2FnZSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgIHJldHVybiBtZXNzYWdlOwogICAgfSk7CiAgfSwKICB2YWxpZGF0ZTogZnVuY3Rpb24gdmFsaWRhdGUoX3JlZjkpIHsKICAgIHZhciBjb21taXQgPSBfcmVmOS5jb21taXQsCiAgICAgICAgc3RhdGUgPSBfcmVmOS5zdGF0ZTsKICAgIGlmICghc3RhdGUuY3VycmVudFVzZXIpIHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbCk7CiAgICB2YXIgdXNlciA9IGdldEZpcmViYXNlQmFja2VuZCgpLmdldEF1dGhlbnRpY2F0ZWRVc2VyKCk7CiAgICBjb21taXQoJ1NFVF9DVVJSRU5UX1VTRVInLCB1c2VyKTsKICAgIHJldHVybiB1c2VyOwogIH0KfTsKCmZ1bmN0aW9uIHNhdmVTdGF0ZShrZXksIHN0YXRlKSB7CiAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgSlNPTi5zdHJpbmdpZnkoc3RhdGUpKTsKfQ=="},{"version":3,"sources":["/Users/thanitnetprokaew/Desktop/yfhs/website/src/state/modules/auth.js"],"names":["getFirebaseBackend","state","currentUser","sessionStorage","getItem","mutations","SET_CURRENT_USER","newValue","saveState","getters","loggedIn","actions","init","dispatch","logIn","commit","email","password","loginUser","then","response","user","logOut","Promise","resolve","reject","logout","catch","error","_handleError","register","registerUser","resetPassword","forgetPassword","message","data","validate","getAuthenticatedUser","key","window","localStorage","setItem","JSON","stringify"],"mappings":"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","sourcesContent":["import { getFirebaseBackend } from '../../authUtils.js'\n\nexport const state = {\n    currentUser: sessionStorage.getItem('authUser'),\n}\n\nexport const mutations = {\n    SET_CURRENT_USER(state, newValue) {\n        state.currentUser = newValue\n        saveState('auth.currentUser', newValue)\n    },\n}\n\nexport const getters = {\n    loggedIn(state) {\n        return !!state.currentUser\n    },\n}\n\nexport const actions = {\n    init({ state, dispatch }) {\n        dispatch('validate')\n    },\n\n    logIn({ commit, dispatch, getters }, { email, password } = {}) {\n        if (getters.loggedIn) return dispatch('validate')\n\n        return getFirebaseBackend().loginUser(email, password).then((response) => {\n            const user = response\n            commit('SET_CURRENT_USER', user)\n            return user\n        });\n    },\n    logOut({ commit }) {\n        commit('SET_CURRENT_USER', null)\n        return new Promise((resolve, reject) => {\n            getFirebaseBackend().logout().then((response) => {\n                resolve(true);\n            }).catch((error) => {\n                reject(this._handleError(error));\n            })\n        });\n    },\n\n    register({ commit, dispatch, getters }, { email, password } = {}) {\n        if (getters.loggedIn) return dispatch('validate')\n\n        return getFirebaseBackend().registerUser(email, password).then((response) => {\n            const user = response\n            commit('SET_CURRENT_USER', user)\n            return user\n        });\n    },\n\n    resetPassword({ commit, dispatch, getters }, { email } = {}) {\n        if (getters.loggedIn) return dispatch('validate')\n\n        return getFirebaseBackend().forgetPassword(email).then((response) => {\n            const message = response.data\n            return message\n        });\n    },\n\n    validate({ commit, state }) {\n        if (!state.currentUser) return Promise.resolve(null)\n        const user = getFirebaseBackend().getAuthenticatedUser();\n        commit('SET_CURRENT_USER', user)\n        return user;\n    },\n}\n\nfunction saveState(key, state) {\n    window.localStorage.setItem(key, JSON.stringify(state))\n}\n"]}]}